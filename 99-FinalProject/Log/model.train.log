:: loading settings :: file = /usr/local/Cellar/spark/spark-2.4.7/external_jars/.ivy2/ivysettings.xml
[INFO] 因变量分布:
+-------------+--------------------+
|HasDetections|count(HasDetections)|
+-------------+--------------------+
|            1|             3125444|
|            0|             3212170|
+-------------+--------------------+

[INFO] 正在计算不同类别下计算机被攻击的比例！
+--------------------------+-------------------+
|Census_IsSecureBootEnabled| avg(HasDetections)|
+--------------------------+-------------------+
|                         0|0.48703178089161825|
|                         1| 0.4974471633091159|
+--------------------------+-------------------+

+------------------------+------------------+
|Census_ActivationChannel|avg(HasDetections)|
+------------------------+------------------+
|              zzz_others|0.5377713283753552|
|             Volume:GVLK|0.5947120554752104|
|                  OEM:DM|0.4952695155321415|
|                  Retail|0.4809692950575452|
+------------------------+------------------+

+-------------------+-------------------+
|AVProductsInstalled| avg(HasDetections)|
+-------------------+-------------------+
|         zzz_others|0.29337132604063654|
|                  1| 0.5438858833733937|
|                  2|0.40131893718663725|
+-------------------+-------------------+

+--------------------------------+-------------------+
|Census_OSWUAutoUpdateOptionsName| avg(HasDetections)|
+--------------------------------+-------------------+
|                          Notify|  0.472992062444063|
|                      zzz_others| 0.4796436254386933|
|                         UNKNOWN|0.48962859472973513|
|                        FullAuto| 0.5107726933741576|
+--------------------------------+-------------------+

[INFO] 正在尝试数据透视！
+------------------------+------------------+-------------------+
|Census_ActivationChannel|                 0|                  1|
+------------------------+------------------+-------------------+
|              zzz_others|0.5332469649771463| 0.5599771379581339|
|             Volume:GVLK|0.5902119012083343| 0.6275704962443049|
|                  OEM:DM|0.4796525962143244| 0.4981521394406581|
|                  Retail|0.4738915680320465|0.49178596447407924|
+------------------------+------------------+-------------------+

+-------------+------------------+-------------------+-------------------+
|EngineVersion|      ExistsNotSet|       RequireAdmin|         zzz_others|
+-------------+------------------+-------------------+-------------------+
|   zzz_others|0.6356968603736401| 0.3139704949344517|0.39041992664506675|
|  1.1.15200.1|0.8273605235852821|0.41573589674493805| 0.4746183393523211|
|  1.1.15100.1|0.8403750006641412|0.49205469632233517|  0.510329504997018|
+-------------+------------------+-------------------+-------------------+

+-------------------+-------------------+-------------------+
|AVProductsInstalled|                  0|                  1|
+-------------------+-------------------+-------------------+
|         zzz_others|0.32069894810049554| 0.2875381180065442|
|                  1| 0.5199413394229895| 0.5665461892282406|
|                  2| 0.3674637418279213|0.41392200836435367|
+-------------------+-------------------+-------------------+

[INFO] 正在对分类变量进行onehot处理!
[INFO] 正在拆分数据集!
[INFO] 开始建模!
[INFO] 正在训练  tree 模型!
[INFO] tree  训练完成!
-------------- Train --------------
+-------------+--------------------+----------+
|HasDetections|         probability|prediction|
+-------------+--------------------+----------+
|            0|[0.63814149852460...|       0.0|
|            1|[0.63814149852460...|       0.0|
|            1|[0.25316691190150...|       1.0|
|            0|[0.63814149852460...|       0.0|
|            1|[0.25316691190150...|       1.0|
+-------------+--------------------+----------+
only showing top 5 rows

-------------- Test --------------
+-------------+--------------------+----------+
|HasDetections|         probability|prediction|
+-------------+--------------------+----------+
|            1|[0.63814149852460...|       0.0|
|            0|[0.63814149852460...|       0.0|
|            1|[0.63814149852460...|       0.0|
|            1|[0.25316691190150...|       1.0|
|            1|[0.63814149852460...|       0.0|
+-------------+--------------------+----------+
only showing top 5 rows

[INFO] 正在对tree  模型进行预测!
[INFO] 训练集召回率为:   62.06325718701359 %
[INFO] 测试集召回率为:   62.061297991597876 %
[INFO] 模型预测完毕!